{% extends "base.html" %}
{% load i18n %}

{% block content %}

<h2>Login with username and password</h2>

<form action="" method="post" class="login mm_clear">
	{% csrf_token %}
	{{ form.as_p }}
	<input type=hidden name=next value={{ next }}>
	<div class="field">
		<button class="btn btn-primary" type="submit">
			{% trans "Login" %}
		</button>
	</div>
</form>


<ul class="socialLogin">
	<li><a title="Google" class="socialaccount_provider google" href="{% url socialauth_begin backend='google' %}"><img src="{{ STATIC_URL }}img/login/google.png" alt="Google"></a></li>

	<li><a title="Yahoo" class="socialaccount_provider yahoo" href="{% url socialauth_begin backend='yahoo' %}"><img src="{{ STATIC_URL }}img/login/yahoo.png" alt="Yahoo"></a></li>

	<li>
		<form method="post" action="{% url socialauth_complete "browserid" %}">
			{% csrf_token %}
			<input type="hidden" name="assertion" value="" />
			<a rel="nofollow" id="browserid" href="#"><img src="{{ STATIC_URL }}img/login/browserid.png" alt="Login using BrowserID" /></a>
		</form>
	</li>

</ul>

{% endblock %}

{% block additionaljs %}
<!-- Include BrowserID JavaScript -->
<script src="https://browserid.org/include.js" type="text/javascript"></script>
<!-- Setup click handler that receives BrowserID assertion code and sends POST data -->
<script type="text/javascript">
	$(function() {
		$('#browserid').click(function(e) {
			e.preventDefault();
			var self = $(this);

			navigator.id.get(function(assertion) {
				if (assertion) {
					self.parent('form').find('input[type=hidden]').attr('value', assertion).end().submit();
				} else {
					alert('Some error occurred');
				}
			});
		});
	}); 
</script>
<!-- end browserid stuff -->
{% endblock additionaljs %}
